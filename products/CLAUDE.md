# CLAUDE.md — Products Subproject

## Обзор

Подпроект для создания цифровых продуктов на основе базы вопросов Selfology.

**Источник данных:** `intelligent_question_core/data/selfology_programs_v2.json`
- 29 программ
- 190 кластеров (blocks)
- 674 вопроса

---

## Текущий продукт: Две книги PDF

### Книга 1: "29 программ самопознания" (тематический подход)
- Пользователь приходит с конкретной болью (отношения, карьера, страхи)
- Открывает оглавление → находит тему → проходит кластеры
- Структура: Программа → Кластеры (от лёгких к глубоким) → Вопросы
- User flow: выбор темы → последовательное погружение внутри темы

### Книга 2: "Путь в глубину" (прогрессивный подход)
- Пользователь хочет исследовать себя без конкретного фокуса
- Постепенное погружение: Часть 1 (легко) → Часть 2 (глубже) → Часть 3 (самое глубокое)
- Темы ЧЕРЕДУЮТСЯ внутри каждого уровня для разнообразия
- Те же кластеры, реорганизованные по глубине

### Метаданные кластера
| Поле | Пример | Использование |
|------|--------|---------------|
| name | "Люди рядом" | Заголовок кластера |
| description | "экосистема влияний" | Контекст |
| type | Foundation/Exploration/Integration | Уровень глубины |
| time | 5-10 / 10-20 / 15-30 мин | Планирование |
| program.name | "Отношения" | Контекст в Книге 2 |

### Языки
- RU (основной)
- EN (перевод)
- ES (перевод)

---

## Текущее состояние

### Что сделано
- [x] Структура папок `products/book/`
- [x] Генератор `scripts/generate_books.py`
- [x] LaTeX шаблон `templates/selfology-book.latex`
- [x] Шаблоны текстов `templates/ru/` (intro, warnings, conclusion)
- [x] Спецификация стиля `templates/STYLE_SPEC.md`
- [x] Генерация PDF работает (book1: 110 стр, book2: 67 стр)
- [x] Экранирование LaTeX символов
- [x] Удаление emoji из исходников

### Проблемы дизайна (статус)
1. **Типографика** — PT Serif/Sans устаревшие, "бабушкины книжки", нет контраста
2. **Визуальная иерархия** — сломана (программа → кластер → вопрос)
3. ✅ **Метаданные** — РЕШЕНО: Book1=Side Margin, Book2=Hanging Indent
4. ✅ **Разделение программ** — РЕШЕНО: page break + chapter opening (номер 48pt + заголовок)
5. ✅ **Квадратные скобки** — РЕШЕНО: Vertical Hierarchy (### program → ## cluster)
6. ✅ **Глубина через дизайн** — РЕШЕНО: Stratification System (weight/spacing/tracking)
7. **User flow** — не проработан

---

## Следующий шаг: Research

Подготовлен промпт для Perplexity для изучения:
- Современные шрифты для RU/EN/ES
- Как показывать глубину визуально (не текстом)
- Премиальные workbooks/journals 2022-2024
- Элегантная интеграция метаданных
- Визуальные системы для вложенной структуры

**Промпт сохранён в:** `products/book/RESEARCH_PROMPT.md`

---

## Структура папок

```
products/
├── CLAUDE.md              ← этот файл
├── README.md              ← обзор продуктов
└── book/
    ├── ALGORITHM.md       ← алгоритм генерации (для PM)
    ├── TECHNICAL_SPEC.md  ← техническая спецификация
    ├── scripts/
    │   └── generate_books.py
    ├── templates/
    │   ├── STYLE_SPEC.md         ← спецификация стиля
    │   ├── selfology-book.latex  ← LaTeX шаблон
    │   └── ru/
    │       ├── intro.md
    │       ├── warnings.md
    │       └── conclusion.md
    └── exports/
        └── ru/
            ├── book1_programs.md
            ├── book1_programs.pdf
            ├── book2_depth.md
            └── book2_depth.pdf
```

---

## Ключевые команды

```bash
# Генерация markdown
cd products/book
python3 scripts/generate_books.py

# Конвертация в PDF
cd exports/ru
pandoc book1_programs.md -o book1_programs.pdf \
  --pdf-engine=xelatex \
  --template=../../templates/selfology-book.latex

pandoc book2_depth.md -o book2_depth.pdf \
  --pdf-engine=xelatex \
  --template=../../templates/selfology-book.latex
```

---

## Принципы дизайна (цель)

- **Минимализм** — но смелый, с контрастом
- **Швейцарская типографика** — современная интерпретация
- **Воздух** — пространство для рефлексии
- **Безопасность** — визуальные сигналы глубины
- **Прогресс** — ощущение движения вперёд
- **Мультиязычность** — работает для кириллицы и латиницы

---

## Что пользователь должен ЧУВСТВОВАТЬ

- Глубину — через визуальный вес, не через слова
- Безопасность — "тут будет непросто, приготовься"
- Прогресс — "я двигаюсь вперёд"
- Пространство — "мне дают время подумать"
