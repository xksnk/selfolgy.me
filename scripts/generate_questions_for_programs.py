#!/usr/bin/env python3
"""
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º –±–µ–∑ –≤–æ–ø—Ä–æ—Å–æ–≤
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç Claude Opus –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
"""
import json
from pathlib import Path
import time
from datetime import datetime
import anthropic
import os
from dotenv import load_dotenv

load_dotenv()

# –ü—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
PROGRAMS_TO_GENERATE = [
    {
        'name': 'AI-—Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å –∏ –±—É–¥—É—â–µ–µ —Ä–∞–±–æ—Ç—ã',
        'themes': ['—Å—Ç—Ä–∞—Ö –∑–∞–º–µ–Ω—ã AI', '—É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —á–µ–ª–æ–≤–µ–∫–∞', '–∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º', '–Ω–∞–≤—ã–∫–∏ –±—É–¥—É—â–µ–≥–æ'],
        'domains': ['WORK', 'FEARS', 'FUTURE', 'IDENTITY'],
        'target_count': 20,
        'priority': 3
    },
    {
        'name': '–í–æ–π–Ω–∞ –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ',
        'themes': ['–¥–æ—Ñ–∞–º–∏–Ω–æ–≤–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å', 'FOMO', '–≥–ª—É–±–æ–∫–∏–π —Ñ–æ–∫—É—Å', '—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–Ω–∏–º–∞–Ω–∏–µ–º', 'shorts/reels'],
        'domains': ['EMOTIONS', 'VALUES', 'WORK', 'CREATIVITY'],
        'target_count': 20,
        'priority': 3
    },
    {
        'name': '–ò–Ω—Ñ–æ-–æ–∂–∏—Ä–µ–Ω–∏–µ',
        'themes': ['–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞', '–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ vs –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ', '—Ü–∏—Ñ—Ä–æ–≤–æ–π –º–∏–Ω–∏–º–∞–ª–∏–∑–º', '–ø–∞—Ä–∞–¥–æ–∫—Å –≤—ã–±–æ—Ä–∞'],
        'domains': ['VALUES', 'WORK', 'GOALS'],
        'target_count': 18,
        'priority': 3
    },
    {
        'name': '–°–∫–æ—Ä–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π',
        'themes': ['VUCA –º–∏—Ä', '–∞–Ω—Ç–∏—Ö—Ä—É–ø–∫–æ—Å—Ç—å', '–∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å', '–Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å', '—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å'],
        'domains': ['EMOTIONS', 'GOALS', 'FUTURE', 'GROWTH'],
        'target_count': 18,
        'priority': 3
    },
    {
        'name': '–í—ã—É—á–µ–Ω–Ω–∞—è –±–µ—Å–ø–æ–º–æ—â–Ω–æ—Å—Ç—å 2.0',
        'themes': ['–≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ç—Ä–µ–≤–æ–≥–∞', '–∫—Ä—É–≥ –≤–ª–∏—è–Ω–∏—è', '–º–∏–∫—Ä–æ-–∞–∫—Ç–∏–≤–∏–∑–º', '–∞–≥–µ–Ω—Ç–Ω–æ—Å—Ç—å', '–Ω–∞–¥–µ–∂–¥–∞'],
        'domains': ['EMOTIONS', 'VALUES', 'GOALS'],
        'target_count': 15,
        'priority': 3
    },
    {
        'name': '–ü–∞—Ä–∞–∑–æ—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å',
        'themes': ['–æ—Ç–Ω–æ—à–µ–Ω–∏—è —Å –±–ª–æ–≥–µ—Ä–∞–º–∏', 'AI –¥—Ä—É–∑—å—è', '—Ü–∏—Ñ—Ä–æ–≤–∞—è –±–ª–∏–∑–æ—Å—Ç—å', '–æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ', '—Ä–µ–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏'],
        'domains': ['RELATIONSHIPS', 'EMOTIONS', 'VALUES'],
        'target_count': 15,
        'priority': 3
    },
    {
        'name': '–ì–∏–±—Ä–∏–¥–Ω–∞—è –∂–∏–∑–Ω—å',
        'themes': ['remote work', '–≥—Ä–∞–Ω–∏—Ü—ã –¥–æ–º-—Ä–∞–±–æ—Ç–∞', 'zoom —É—Å—Ç–∞–ª–æ—Å—Ç—å', '–Ω–æ–≤–∞—è —Å–æ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å', '–±–∞–ª–∞–Ω—Å online/offline'],
        'domains': ['WORK', 'RELATIONSHIPS', 'VALUES'],
        'target_count': 15,
        'priority': 3
    },
    {
        'name': '–ê—É—Ç–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å vs –ê–ª–≥–æ—Ä–∏—Ç–º—ã',
        'themes': ['–ª–∏—á–Ω—ã–π –±—Ä–µ–Ω–¥', '–∏—Å–∫—Ä–µ–Ω–Ω–æ—Å—Ç—å', 'cancel culture', '—É—è–∑–≤–∏–º–æ—Å—Ç—å –æ–Ω–ª–∞–π–Ω', '–≤–µ—Ä—Å–∏–∏ —Å–µ–±—è'],
        'domains': ['IDENTITY', 'VALUES', 'RELATIONSHIPS'],
        'target_count': 15,
        'priority': 3
    },
    {
        'name': '–≠–∫–æ-–≤–∏–Ω–∞ –∏ –∫–ª–∏–º–∞—Ç-—Ç—Ä–µ–≤–æ–≥–∞',
        'themes': ['–ª–∏—á–Ω–∞—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å', '—Å–∏—Å—Ç–µ–º–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è', '—É—Å—Ç–æ–π—á–∏–≤–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ', '—ç–∫–æ–ª–æ–≥–∏—á–Ω–æ—Å—Ç—å'],
        'domains': ['VALUES', 'EMOTIONS'],
        'target_count': 12,
        'priority': 3
    },
    {
        'name': '–ü–æ–ª—è—Ä–∏–∑–∞—Ü–∏—è –∏ —ç–º–ø–∞—Ç–∏—è',
        'themes': ['—ç—Ö–æ-–∫–∞–º–µ—Ä—ã', '–¥–∏–∞–ª–æ–≥ —Å –¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω–æ–π', '—Å–ª–æ–∂–Ω–æ—Å—Ç—å –º—ã—à–ª–µ–Ω–∏—è', '—É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–π'],
        'domains': ['RELATIONSHIPS', 'VALUES', 'EMOTIONS'],
        'target_count': 12,
        'priority': 3
    },
    {
        'name': 'Dating apps –≤—ã–≥–æ—Ä–∞–Ω–∏–µ',
        'themes': ['—É—Å—Ç–∞–ª–æ—Å—Ç—å –æ—Ç —Å–≤–∞–π–ø–æ–≤', '–∫–æ–º–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏–π', '–ø–æ–∏—Å–∫ –±–ª–∏–∑–æ—Å—Ç–∏', '—Ü–∏—Ñ—Ä–æ–≤–∞—è —Ä–æ–º–∞–Ω—Ç–∏–∫–∞'],
        'domains': ['RELATIONSHIPS', 'EMOTIONS'],
        'target_count': 8,
        'priority': 4
    },
    {
        'name': '–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –≤–∏–Ω–∞ –∑–∞ —ç–∫—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è',
        'themes': ['—ç–∫—Ä–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –¥–µ—Ç–µ–π', '—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∞—è –≤–∏–Ω–∞', '—Ü–∏—Ñ—Ä–æ–≤–æ–µ –≤–æ—Å–ø–∏—Ç–∞–Ω–∏–µ', '–±–∞–ª–∞–Ω—Å —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π'],
        'domains': ['RELATIONSHIPS', 'VALUES', 'EMOTIONS'],
        'target_count': 8,
        'priority': 4
    },
    {
        'name': '–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–µ FOMO',
        'themes': ['—É–ø—É—â–µ–Ω–Ω–∞—è –≤—ã–≥–æ–¥–∞', '—Å–ø–µ–∫—É–ª—è—Ç–∏–≤–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ', '–±—ã—Å—Ç—Ä—ã–µ –¥–µ–Ω—å–≥–∏', '—Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Ç—Ä–µ–≤–æ–≥–∞'],
        'domains': ['VALUES', 'EMOTIONS', 'FEARS'],
        'target_count': 6,
        'priority': 4
    }
]

def generate_prompt(program):
    """–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤"""

    example_questions = """
–ü—Ä–∏–º–µ—Ä—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–∑ –±–∞–∑—ã:

SURFACE (–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–µ):
- –ö–∞–∫ —á–∞—Å—Ç–æ —Ç—ã –ø—Ä–æ–≤–µ—Ä—è–µ—à—å —Ç–µ–ª–µ—Ñ–æ–Ω –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è?
- –ö–∞–∫–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–±–∏—Ä–∞—é—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ç–≤–æ–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏?

CONSCIOUS (–æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–µ):
- –ß—Ç–æ —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å, –∫–æ–≥–¥–∞ –Ω–µ –º–æ–∂–µ—à—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?
- –ö–∞–∫—É—é –ø—É—Å—Ç–æ—Ç—É —Ç—ã –∑–∞–ø–æ–ª–Ω—è–µ—à—å –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–æ–º?

EDGE (–Ω–∞ –≥—Ä–∞–Ω–∏):
- –û—Ç –∫–∞–∫–æ–π –±–æ–ª–∏ —Ç—ã –ø—Ä—è—á–µ—à—å—Å—è –≤ —Ü–∏—Ñ—Ä–æ–≤–æ–º –º–∏—Ä–µ?
- –ö–µ–º —Ç—ã —Å—Ç–∞–Ω–æ–≤–∏—à—å—Å—è –±–µ–∑ —Å–≤–æ–∏—Ö —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –º–∞—Å–æ–∫?

SHADOW (—Ç–µ–Ω–µ–≤—ã–µ):
- –ö–∞–∫—É—é —á–∞—Å—Ç—å —Å–µ–±—è —Ç—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–æ–∫–∞–∂–µ—à—å –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö?
- –ß—Ç–æ —É–º—Ä–µ—Ç –≤ —Ç–µ–±–µ, –µ—Å–ª–∏ —Ç—ã –æ—Å—Ç–∞–Ω–µ—à—å—Å—è –±–µ–∑ –ª–∞–π–∫–æ–≤?

CORE (—è–¥–µ—Ä–Ω—ã–µ):
- –ö—Ç–æ —Ç—ã, –∫–æ–≥–¥–∞ –Ω–∏–∫—Ç–æ –Ω–µ —Å–º–æ—Ç—Ä–∏—Ç –∏ –Ω–µ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç?
- –°—É—â–µ—Å—Ç–≤—É–µ—à—å –ª–∏ —Ç—ã –≤–Ω–µ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ —Å–ª–µ–¥–∞?
"""

    prompt = f"""–¢—ã - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø—Å–∏—Ö–æ–ª–æ–≥, —Å–æ–∑–¥–∞—é—â–∏–π –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å–∞–º–æ–ø–æ–∑–Ω–∞–Ω–∏—è "{program['name']}".

–¢–µ–º—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã: {', '.join(program['themes'])}

{example_questions}

–°–æ–∑–¥–∞–π {program['target_count']} –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –¥–ª—è —ç—Ç–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
1. –í–æ–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏, –ø—Ä–æ–≤–æ—Ü–∏—Ä–æ–≤–∞—Ç—å –≥–ª—É–±–æ–∫—É—é —Ä–µ—Ñ–ª–µ–∫—Å–∏—é
2. –ë–µ–∑ —Å–æ–≤–µ—Ç–æ–≤, –æ—Ü–µ–Ω–æ–∫, —Å—É–∂–¥–µ–Ω–∏–π - —Ç–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å—ã
3. –ò—Å–ø–æ–ª—å–∑—É–π "—Ç—ã" –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è
4. –í–æ–ø—Ä–æ—Å—ã –∫–æ—Ä–æ—Ç–∫–∏–µ –∏ —ë–º–∫–∏–µ (5-15 —Å–ª–æ–≤ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ)
5. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≥–ª—É–±–∏–Ω–µ:
   - 3-4 SURFACE (–ª–µ–≥–∫–∏–µ, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ)
   - 6-8 CONSCIOUS (–æ—Å–æ–∑–Ω–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤)
   - 4-6 EDGE (–Ω–µ—É–¥–æ–±–Ω—ã–µ, –Ω–∞ –≥—Ä–∞–Ω–∏ –∫–æ–º—Ñ–æ—Ä—Ç–∞)
   - 2-3 SHADOW (–≥–ª—É–±–∏–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ö–∏, —Ç–µ–Ω–∏)
   - 1-2 CORE (—ç–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ)

6. –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å:
   - OPENING (2-3): –æ—Ç–∫—Ä—ã–≤–∞—é—â–∏–µ, –ª–µ–≥–∫–∏–µ
   - NEUTRAL (8-10): –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
   - PROCESSING (4-5): –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–µ —ç–º–æ—Ü–∏–∏
   - HEAVY (2-3): —Ç—è–∂–µ–ª—ã–µ, –±–æ–ª–µ–∑–Ω–µ–Ω–Ω—ã–µ
   - HEALING (2-3): –∏—Å—Ü–µ–ª—è—é—â–∏–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ

–§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê - —Å—Ç—Ä–æ–≥–∏–π JSON:
[
  {{
    "text": "—Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞",
    "depth_level": "SURFACE|CONSCIOUS|EDGE|SHADOW|CORE",
    "energy_dynamic": "OPENING|NEUTRAL|PROCESSING|HEAVY|HEALING",
    "domain": "{program['domains'][0]}",
    "theme": "–æ–¥–Ω–∞ –∏–∑ —Ç–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã"
  }}
]

–í–ê–ñ–ù–û: –í–æ–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –æ—Ç—Ä–∞–∂–∞—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∏ 2024-2025 –≥–æ–¥–æ–≤ –∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É —Ç–µ–º—ã "{program['name']}"."""

    return prompt

def generate_questions(program, client):
    """–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ Claude API"""

    print(f"\nü§ñ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã: {program['name']}")
    print(f"   –¶–µ–ª–µ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: {program['target_count']}")

    prompt = generate_prompt(program)

    print(f"   üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –≤ Claude API...")

    try:
        response = client.messages.create(
            model="claude-3-5-haiku-20241022",  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å
            max_tokens=4000,
            temperature=0.8,
            messages=[
                {"role": "user", "content": prompt}
            ]
        )

        print(f"   ‚úÖ –û—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω")

        # –ò–∑–≤–ª–µ—á—å JSON –∏–∑ –æ—Ç–≤–µ—Ç–∞
        response_text = response.content[0].text

        # –ù–∞–π—Ç–∏ JSON –≤ —Ç–µ–∫—Å—Ç–µ
        import re
        json_match = re.search(r'\[.*\]', response_text, re.DOTALL)
        if json_match:
            json_str = json_match.group()
            questions = json.loads(json_str)

            # –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
            for i, q in enumerate(questions, 1):
                q['id'] = f"gen_{program['name'][:3].lower()}_{i:03d}"
                q['program'] = program['name']
                q['generated_at'] = datetime.now().isoformat()
                q['classification'] = {
                    'journey_stage': 'EXPLORING',
                    'depth_level': q['depth_level'],
                    'domain': q['domain'],
                    'energy_dynamic': q['energy_dynamic']
                }
                q['source_system'] = 'generated_2025'

            print(f"   ‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: {len(questions)} –≤–æ–ø—Ä–æ—Å–æ–≤")
            return questions
        else:
            print(f"   ‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–≤–ª–µ—á—å JSON –∏–∑ –æ—Ç–≤–µ—Ç–∞")
            return []

    except Exception as e:
        print(f"   ‚ùå –û—à–∏–±–∫–∞: {e}")
        print(f"   üìù –¢–∏–ø –æ—à–∏–±–∫–∏: {type(e).__name__}")
        import traceback
        print(f"   üîç –¢—Ä–µ–π—Å: {traceback.format_exc()}")
        return []

def main():
    print("üé® –ì–ï–ù–ï–†–ê–¶–ò–Ø –í–û–ü–†–û–°–û–í –î–õ–Ø –ù–û–í–´–• –ü–†–û–ì–†–ê–ú–ú\n")
    print("="*80)

    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–ª—é—á
    api_key = os.getenv('ANTHROPIC_API_KEY')
    if not api_key:
        print("‚ùå ANTHROPIC_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ .env")
        print("\n–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω—É–∂–µ–Ω API –∫–ª—é—á Claude.")
        print("–î–æ–±–∞–≤—å—Ç–µ –≤ .env —Ñ–∞–π–ª:")
        print("ANTHROPIC_API_KEY=your-key-here")
        return

    client = anthropic.Anthropic(api_key=api_key)

    all_generated = []

    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–ª—è –≤—Å–µ—Ö –ø—Ä–æ–≥—Ä–∞–º–º
    for i, program in enumerate(PROGRAMS_TO_GENERATE):
        print(f"\n[{i+1}/{len(PROGRAMS_TO_GENERATE)}] –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã...")
        questions = generate_questions(program, client)

        if questions:
            all_generated.append({
                'program': program['name'],
                'questions': questions,
                'metadata': {
                    'themes': program['themes'],
                    'domains': program['domains'],
                    'priority': program['priority'],
                    'generated_count': len(questions),
                    'target_count': program['target_count']
                }
            })

        # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
        time.sleep(2)

    # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    output_file = Path('prompts/generated_questions_for_programs.json')

    with open(output_file, 'w', encoding='utf-8') as f:
        json.dump({
            'metadata': {
                'generated_at': datetime.now().isoformat(),
                'total_programs': len(PROGRAMS_TO_GENERATE),
                'successful_programs': len(all_generated),
                'total_questions': sum(len(p['questions']) for p in all_generated)
            },
            'programs': all_generated
        }, f, ensure_ascii=False, indent=2)

    print(f"\n\n{'='*80}")
    print(f"‚úÖ –ì–ï–ù–ï–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê\n")
    print(f"–ü—Ä–æ–≥—Ä–∞–º–º –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: {len(all_generated)}/{len(PROGRAMS_TO_GENERATE)}")
    print(f"–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤ —Å–æ–∑–¥–∞–Ω–æ: {sum(len(p['questions']) for p in all_generated)}")
    print(f"\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ: {output_file}")

if __name__ == '__main__':
    main()