# ROADMAP: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –±–ª–æ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≥—Ä–∞–º–º

## –û–±–∑–æ—Ä

**–¶–µ–ª—å:** –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –±–ª–æ—á–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º (ProgramRouter) —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∞–Ω–∞–ª–∏–∑–∞.

### –î–≤–∞ —Ä–µ–∂–∏–º–∞ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞

| –†–µ–∂–∏–º | –¶–µ–ª—å | –õ–æ–≥–∏–∫–∞ |
|-------|------|--------|
| **üéØ –ê–≤—Ç–æ** | –ë—ã—Å—Ç—Ä–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –æ—Ç–ø–µ—á–∞—Ç–æ–∫ | AI –≤—ã–±–∏—Ä–∞–µ—Ç –±–ª–æ–∫–∏ –∏–∑ –õ–Æ–ë–û–ô –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∑–∞–∫—Ä—ã–≤–∞—è –ø—Ä–æ–±–µ–ª—ã –≤ –ø—Ä–æ—Ñ–∏–ª–µ |
| **üìö –ü—Ä–æ–≥—Ä–∞–º–º–∞** | –î–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–æ–π—Ç–∏ —Ç–æ, —á—Ç–æ –æ–Ω —Ö–æ—á–µ—Ç | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É, –ø—Ä–æ—Ö–æ–¥–∏—Ç –µ—ë –ø–æ–ª–Ω–æ—Å—Ç—å—é |

### UX Flow

```
/onboarding
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ö–∞–∫ –≤—ã —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å?                  ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ  [üéØ –ê–≤—Ç–æ]  [üìö –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚Üì                         ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç  ‚îÇ    ‚îÇ –°–ø–∏—Å–æ–∫ 29       ‚îÇ
‚îÇ –ø—Ä–æ—Ñ–∏–ª—å –∏       ‚îÇ    ‚îÇ –ø—Ä–æ–≥—Ä–∞–º–º        ‚îÇ
‚îÇ –≤—ã–±–∏—Ä–∞–µ—Ç –±–ª–æ–∫   ‚îÇ    ‚îÇ —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏    ‚îÇ
‚îÇ –∏–∑ –ª—é–±–æ–π        ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ –ø—Ä–æ–≥—Ä–∞–º–º—ã       ‚îÇ    ‚îÇ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å    ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ –≤—ã–±–∏—Ä–∞–µ—Ç        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                      ‚îÇ
         ‚ñº                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ë–ª–æ–∫ (4-6 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –æ–¥–Ω–æ–º—É)          ‚îÇ
‚îÇ  ‚Üí –í–æ–ø—Ä–æ—Å ‚Üí –û—Ç–≤–µ—Ç ‚Üí –ê–Ω–∞–ª–∏–∑ ‚Üí –í–æ–ø—Ä–æ—Å...  ‚îÇ
‚îÇ  ‚Üí "–ë–ª–æ–∫ –∑–∞–≤–µ—Ä—à—ë–Ω!"                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                      ‚îÇ
         ‚ñº                      ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ AI –≤—ã–±–∏—Ä–∞–µ—Ç     ‚îÇ    ‚îÇ –°–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫  ‚îÇ
‚îÇ —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫  ‚îÇ    ‚îÇ –¢–û–ô –ñ–ï          ‚îÇ
‚îÇ (–º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑  ‚îÇ    ‚îÇ –ø—Ä–æ–≥—Ä–∞–º–º—ã       ‚îÇ
‚îÇ –¥—Ä—É–≥–æ–π          ‚îÇ    ‚îÇ –ø–æ –ø–æ—Ä—è–¥–∫—É      ‚îÇ
‚îÇ –ø—Ä–æ–≥—Ä–∞–º–º—ã!)     ‚îÇ    ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ê–≤—Ç–æ-—Ä–µ–∂–∏–º: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –≤—ã–±–æ—Ä–∞ –±–ª–æ–∫–∞

1. **–û—Ö–≤–∞—Ç –¥–æ–º–µ–Ω–æ–≤** ‚Äî –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ CAREER, –≤—ã–±—Ä–∞—Ç—å –±–ª–æ–∫ –ø—Ä–æ –∫–∞—Ä—å–µ—Ä—É
2. **–ì–ª—É–±–∏–Ω–∞ –ø—Ä–æ—Ñ–∏–ª—è** ‚Äî –µ—Å–ª–∏ IDENTITY –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω—ã–π, —É–≥–ª—É–±–∏—Ç—å
3. **–≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å** ‚Äî –Ω–µ –¥–∞–≤–∞—Ç—å HEAVY –ø–æ—Å–ª–µ HEAVY
4. **–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å** ‚Äî —É—á–∏—Ç—ã–≤–∞—Ç—å —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏–ª –≤ —á–∞—Ç–µ

---

## –§–ê–ó–ê 1: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (MVP)

### 1.1 –ù–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è FSM
**–§–∞–π–ª:** `selfology_controller.py`

```python
class OnboardingStates(StatesGroup):
    # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
    gdpr_consent = State()
    onboarding_active = State()
    waiting_for_answer = State()

    # üÜï –ù–æ–≤—ã–µ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º
    choosing_mode = State()           # –í—ã–±–æ—Ä: –∞–≤—Ç–æ / –≤—Ä—É—á–Ω—É—é
    choosing_program = State()        # –í—ã–±–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑ —Å–ø–∏—Å–∫–∞
    program_active = State()          # –ê–∫—Ç–∏–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
    waiting_program_answer = State()  # –û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ
    block_transition = State()        # –ü–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏
```

### 1.2 –ò–∑–º–µ–Ω–µ–Ω–∏–µ cmd_onboarding
**–§–∞–π–ª:** `selfology_controller.py`

```python
async def cmd_onboarding(self, message: Message, state: FSMContext):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å–µ—Å—Å–∏—é
    session = await self.onboarding_orchestrator.restore_session_from_db(int(telegram_id))

    if session:
        # –ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è - —Å–ø—Ä–∞—à–∏–≤–∞–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–ª–∏ –Ω–∞—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É
        await message.answer(
            "–£ –≤–∞—Å –µ—Å—Ç—å –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è.\n\n"
            "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –µ—ë –∏–ª–∏ –Ω–∞—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É?",
            reply_markup=InlineKeyboardMarkup(inline_keyboard=[
                [InlineKeyboardButton(text="‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å", callback_data="continue_session")],
                [InlineKeyboardButton(text="üìö –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É", callback_data="choose_program")]
            ])
        )
    else:
        # –ù–æ–≤–∞—è —Å–µ—Å—Å–∏—è - –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
        await message.answer(
            "üß† –ö–∞–∫ –≤—ã —Ö–æ—Ç–∏—Ç–µ –Ω–∞—á–∞—Ç—å –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ?\n\n"
            "**–ê–≤—Ç–æ-–ø–æ–¥–±–æ—Ä** ‚Äî AI –≤—ã–±–µ—Ä–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è\n"
            "**–ü—Ä–æ–≥—Ä–∞–º–º–∞** ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É—Ç—å –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–µ–º–µ",
            reply_markup=InlineKeyboardMarkup(inline_keyboard=[
                [InlineKeyboardButton(text="üéØ –ê–≤—Ç–æ-–ø–æ–¥–±–æ—Ä", callback_data="mode_auto")],
                [InlineKeyboardButton(text="üìö –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É", callback_data="mode_program")]
            ])
        )
        await state.set_state(OnboardingStates.choosing_mode)
```

### 1.3 –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
**–§–∞–π–ª:** `selfology_controller.py`

```python
async def callback_mode_auto(self, callback: CallbackQuery, state: FSMContext):
    """–ê–≤—Ç–æ-—Ä–µ–∂–∏–º - —Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ QuestionRouter"""
    result = await self.onboarding_orchestrator.start_onboarding(int(telegram.id))
    # ... –ø–æ–∫–∞–∑ –≤–æ–ø—Ä–æ—Å–∞ –∫–∞–∫ —Ä–∞–Ω—å—à–µ

async def callback_mode_program(self, callback: CallbackQuery, state: FSMContext):
    """–í—ã–±–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫"""
    programs = await self.onboarding_orchestrator.get_available_programs(int(telegram_id))

    # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–ø–∏—Å–æ–∫ –∫–Ω–æ–ø–æ–∫ (–ø–µ—Ä–≤—ã–µ 10 –ø—Ä–æ–≥—Ä–∞–º–º + "–ï—â—ë")
    buttons = []
    for p in programs[:10]:
        buttons.append([InlineKeyboardButton(
            text=f"{p['name']} ({p['questions_count']} –≤–æ–ø—Ä–æ—Å–æ–≤)",
            callback_data=f"program:{p['program_id']}"
        )])

    await callback.message.edit_text(
        "üìö –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É:\n\n"
        "–ö–∞–∂–¥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—É—Ç—å –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–ª–æ–∫–æ–≤.",
        reply_markup=InlineKeyboardMarkup(inline_keyboard=buttons)
    )
    await state.set_state(OnboardingStates.choosing_program)

async def callback_select_program(self, callback: CallbackQuery, state: FSMContext):
    """–í—ã–±—Ä–∞–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ - –Ω–∞—á–∏–Ω–∞–µ–º"""
    program_id = callback.data.split(":")[1]

    result = await self.onboarding_orchestrator.start_program(
        int(telegram_id), program_id
    )

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º program_id –≤ state
    await state.update_data(program_id=program_id)

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å –ø—Ä–æ–≥—Ä–∞–º–º—ã
    await self._show_program_question(result['question'], result, callback.message)
    await state.set_state(OnboardingStates.waiting_program_answer)
```

### 1.4 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –∫ ProgramRouter
**–§–∞–π–ª:** `selfology_bot/services/onboarding/orchestrator.py`

–ú–µ—Ç–æ–¥ `process_program_answer`:
```python
async def process_program_answer(
    self, user_id: int, program_id: str, question_id: str, answer_text: str
) -> Dict[str, Any]:
    """
    –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç–≤–µ—Ç –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ ‚Äî —Å –ø–æ–ª–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º.

    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ –ª–æ–≥–∏–∫—É —á—Ç–æ process_user_answer, –Ω–æ:
    - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç program_id –∏ block_id –≤ answer
    - –ü–æ–ª—É—á–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ ProgramRouter
    """

    # 1. –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç–≤–µ—Ç –≤ –ë–î (—Å program_id)
    answer_id = await self.onboarding_dao.save_answer_with_program(
        user_id, question_id, answer_text, program_id
    )

    # 2. –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∞–ª–∏–∑ (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
    analysis_result = await self.answer_analyzer.analyze_answer(
        user_id=user_id,
        question_id=question_id,
        answer_text=answer_text,
        question_metadata=question_metadata  # –ò–∑ program_questions
    )

    # 3. –°–æ–∑–¥–∞—ë–º embeddings (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
    await self.embedding_creator.create_embeddings(
        user_id=user_id,
        answer_text=answer_text,
        analysis=analysis_result,
        program_context={"program_id": program_id, "block_id": block_id}
    )

    # 4. –û–±–Ω–æ–≤–ª—è–µ–º –ª–∏—á–Ω–æ—Å—Ç—å (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
    await self.personality_extractor.update_profile(user_id, analysis_result)

    # 5. –ü–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ ProgramRouter
    answered_ids = await self._get_answered_question_ids(user_id, program_id)
    next_result = await self.program_router.get_next_question_in_block(
        user_id, program_id, answered_ids
    )

    return {
        "analysis": analysis_result,
        "next_question": next_result
    }
```

---

## –§–ê–ó–ê 2: –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 2.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã user_answers_new
```sql
ALTER TABLE selfology.user_answers_new
ADD COLUMN program_id VARCHAR(100),
ADD COLUMN block_id VARCHAR(150);

CREATE INDEX idx_answers_program ON selfology.user_answers_new(program_id);
```

### 2.2 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ answer_analysis
```sql
ALTER TABLE selfology.answer_analysis
ADD COLUMN program_id VARCHAR(100),
ADD COLUMN block_id VARCHAR(150),
ADD COLUMN block_type VARCHAR(20);  -- Foundation/Exploration/Integration
```

### 2.3 –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å–∞ –∏–∑ –ë–î
**–§–∞–π–ª:** `selfology_bot/services/onboarding/orchestrator.py`

```python
async def _get_question_metadata_from_db(self, question_id: str) -> Dict:
    """–ü–æ–ª—É—á–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å–∞ –∏–∑ program_questions –≤–º–µ—Å—Ç–æ JSON"""
    async with self.db_service.pool.acquire() as conn:
        row = await conn.fetchrow("""
            SELECT
                journey_stage, depth_level, domain, energy_dynamic,
                complexity, emotional_weight, safety_level,
                trust_requirement, recommended_model
            FROM selfology.program_questions
            WHERE question_id = $1
        """, question_id)

        return dict(row) if row else {}
```

### 2.4 –£—á—ë—Ç –±–ª–æ–∫–∞ –≤ AI —Ä–æ—É—Ç–∏–Ω–≥–µ
**–§–∞–π–ª:** `services/chat_coach.py` (Enhanced Router)

```python
def select_model_for_question(self, question_metadata: Dict) -> str:
    """–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ —Å —É—á—ë—Ç–æ–º block_type"""

    # –ò–∑ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º—ã
    block_type = question_metadata.get('block_type')
    recommended = question_metadata.get('recommended_model')

    if recommended:
        return recommended

    # Fallback –ø–æ block_type
    if block_type == 'Integration':
        return 'claude-sonnet-4'  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç—Ä–µ–±—É—é—Ç –∫–∞—á–µ—Å—Ç–≤–∞
    elif block_type == 'Exploration':
        return 'gpt-4o'
    else:
        return 'gpt-4o-mini'
```

---

## –§–ê–ó–ê 3: –ü—Ä–æ–≥—Ä–µ—Å—Å –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### 3.1 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ user_program_progress
```python
async def update_program_progress(self, user_id: int, program_id: str, question_id: str):
    """–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å"""
    async with self.db_service.pool.acquire() as conn:
        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫
        await conn.execute("""
            UPDATE selfology.user_program_progress
            SET
                questions_answered = questions_answered + 1,
                last_activity_at = NOW()
            WHERE user_id = $1 AND program_id = $2 AND status = 'active'
        """, user_id, program_id)

        # –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç
        await conn.execute("""
            UPDATE selfology.user_program_progress up
            SET completion_percentage = (
                SELECT ROUND(100.0 * up.questions_answered / COUNT(*))
                FROM selfology.program_questions pq
                WHERE pq.program_id = up.program_id
            )
            WHERE user_id = $1 AND program_id = $2
        """, user_id, program_id)
```

### 3.2 –ü–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏
```python
async def handle_block_transition(
    self, user_id: int, program_id: str, callback: CallbackQuery
):
    """–ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–µ—Ä–µ—Ö–æ–¥–µ –∫ –Ω–æ–≤–æ–º—É –±–ª–æ–∫—É"""
    next_block = await self.program_router.get_next_block(user_id, program_id)

    if not next_block:
        # –ü—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
        return await self._complete_program(user_id, program_id, callback)

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    block_emoji = {"Foundation": "üå±", "Exploration": "üîç", "Integration": "üéØ"}

    await callback.message.answer(
        f"‚úÖ –ë–ª–æ–∫ –∑–∞–≤–µ—Ä—à—ë–Ω!\n\n"
        f"–°–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫:\n"
        f"{block_emoji[next_block['type']]} **{next_block['name']}**\n"
        f"_{next_block['description']}_\n\n"
        f"–í–æ–ø—Ä–æ—Å–æ–≤: {next_block['questions_count']}",
        reply_markup=InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å", callback_data="continue_block")],
            [InlineKeyboardButton(text="‚è∏ –ü–∞—É–∑–∞", callback_data="pause_program")]
        ])
    )
```

### 3.3 –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
```python
async def _complete_program(self, user_id: int, program_id: str, target):
    """–ó–∞–≤–µ—Ä—à–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –∏ –ø–æ–∫–∞–∑–∞—Ç—å –∏—Ç–æ–≥–∏"""

    # –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    progress = await self.program_router.get_program_context(user_id, program_id)

    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–Ω—Å–∞–π—Ç—ã –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–µ
    insights = await self._generate_program_insights(user_id, program_id)

    await target.answer(
        f"üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É **{progress.program_name}**!\n\n"
        f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:\n"
        f"‚Ä¢ –ë–ª–æ–∫–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ: {len(progress.blocks_completed)}\n"
        f"‚Ä¢ –í–æ–ø—Ä–æ—Å–æ–≤ –æ—Ç–≤–µ—á–µ–Ω–æ: {progress.questions_answered}\n\n"
        f"üí° –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã:\n{insights}",
        reply_markup=InlineKeyboardMarkup(inline_keyboard=[
            [InlineKeyboardButton(text="üìö –î—Ä—É–≥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞", callback_data="choose_program")],
            [InlineKeyboardButton(text="üí¨ –ß–∞—Ç —Å –∫–æ—É—á–µ–º", callback_data="start_chat")]
        ])
    )
```

---

## –§–ê–ó–ê 4: –ê–≤—Ç–æ-—Ä–µ–∂–∏–º (BlockSelector)

### 4.1 –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç: AutoBlockSelector
**–§–∞–π–ª:** `selfology_bot/services/onboarding/auto_block_selector.py`

–í—ã–±–∏—Ä–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫ –∏–∑ –õ–Æ–ë–û–ô –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ—Ö–≤–∞—Ç–∞ –ø—Ä–æ—Ñ–∏–ª—è.

```python
class AutoBlockSelector:
    """
    –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –±–ª–æ–∫–∞ –¥–ª—è –∞–≤—Ç–æ-—Ä–µ–∂–∏–º–∞.

    –¶–µ–ª—å: –±—ã—Å—Ç—Ä–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏—Ñ—Ä–æ–≤–æ–π –æ—Ç–ø–µ—á–∞—Ç–æ–∫ –ª–∏—á–Ω–æ—Å—Ç–∏.
    """

    async def select_next_block(self, user_id: int) -> Dict[str, Any]:
        """
        –í—ã–±—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫ –∏–∑ –ª—é–±–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã.

        –ê–ª–≥–æ—Ä–∏—Ç–º:
        1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ñ–∏–ª—å (domain coverage)
        2. –ù–∞–π—Ç–∏ "–ø—Ä–æ–±–µ–ª—ã" ‚Äî –¥–æ–º–µ–Ω—ã —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω—ã—Ö
        3. –ù–∞–π—Ç–∏ –±–ª–æ–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç —ç—Ç–∏ –ø—Ä–æ–±–µ–ª—ã
        4. –£—á–µ—Å—Ç—å —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å
        5. –í—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–ª–æ–∫
        """

        # 1. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
        profile_gaps = await self._analyze_profile_gaps(user_id)
        # –ü—Ä–∏–º–µ—Ä: {"CAREER": 0.2, "RELATIONSHIPS": 0.8, "IDENTITY": 0.5}

        # 2. –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–µ –±–ª–æ–∫–∏
        completed_blocks = await self._get_completed_blocks(user_id)

        # 3. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –±–ª–æ–∫–∏ —Å –∏—Ö –¥–æ–º–µ–Ω–∞–º–∏
        available_blocks = await self._get_available_blocks(completed_blocks)

        # 4. –°–∫–æ—Ä–∏–Ω–≥ –±–ª–æ–∫–æ–≤
        scored_blocks = []
        for block in available_blocks:
            score = self._calculate_block_score(
                block=block,
                profile_gaps=profile_gaps,
                last_energy=await self._get_last_energy(user_id)
            )
            scored_blocks.append((block, score))

        # 5. –í—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–π
        scored_blocks.sort(key=lambda x: x[1], reverse=True)
        selected = scored_blocks[0][0]

        return {
            "block_id": selected["block_id"],
            "block_name": selected["name"],
            "program_name": selected["program_name"],
            "reason": self._generate_reason(selected, profile_gaps)
        }

    def _calculate_block_score(
        self,
        block: Dict,
        profile_gaps: Dict[str, float],
        last_energy: str
    ) -> float:
        """
        –°–∫–æ—Ä–∏–Ω–≥ –±–ª–æ–∫–∞.

        –§–∞–∫—Ç–æ—Ä—ã:
        - gap_coverage: –Ω–∞—Å–∫–æ–ª—å–∫–æ –±–ª–æ–∫ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ–±–µ–ª—ã (0-1)
        - energy_balance: –Ω–µ HEAVY –ø–æ—Å–ª–µ HEAVY (0-1)
        - foundation_priority: Foundation –±–ª–æ–∫–∏ –≤–∞–∂–Ω–µ–µ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        - diversity: —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º
        """
        score = 0.0

        # –ü–æ–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–±–µ–ª–æ–≤ (–≥–ª–∞–≤–Ω—ã–π —Ñ–∞–∫—Ç–æ—Ä)
        block_domain = block.get("primary_domain", "GENERAL")
        gap_value = profile_gaps.get(block_domain, 0.5)
        score += (1 - gap_value) * 0.5  # –ß–µ–º –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö, —Ç–µ–º –≤—ã—à–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

        # –≠–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å
        if last_energy == "HEAVY" and block.get("energy_dynamic") == "HEAVY":
            score -= 0.3  # –®—Ç—Ä–∞—Ñ –∑–∞ HEAVY –ø–æ—Å–ª–µ HEAVY
        elif last_energy == "HEAVY" and block.get("energy_dynamic") == "HEALING":
            score += 0.2  # –ë–æ–Ω—É—Å –∑–∞ HEALING –ø–æ—Å–ª–µ HEAVY

        # Foundation –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –Ω–æ–≤—ã—Ö
        if block.get("block_type") == "Foundation":
            score += 0.1

        return score

    async def _analyze_profile_gaps(self, user_id: int) -> Dict[str, float]:
        """
        –ê–Ω–∞–ª–∏–∑ –ø–æ–∫—Ä—ã—Ç–∏—è –¥–æ–º–µ–Ω–æ–≤ –≤ –ø—Ä–æ—Ñ–∏–ª–µ.

        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: {domain: coverage} –≥–¥–µ coverage 0-1
        0 = –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö, 1 = –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
        """
        async with self.db_pool.acquire() as conn:
            # –°—á–∏—Ç–∞–µ–º –æ—Ç–≤–µ—Ç—ã –ø–æ –¥–æ–º–µ–Ω–∞–º
            domain_counts = await conn.fetch("""
                SELECT
                    pq.domain,
                    COUNT(*) as answer_count
                FROM selfology.user_answers_new ua
                JOIN selfology.program_questions pq ON ua.question_json_id = pq.question_id
                WHERE ua.user_id = $1
                GROUP BY pq.domain
            """, user_id)

            # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º (5 –æ—Ç–≤–µ—Ç–æ–≤ = –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ)
            all_domains = [
                "IDENTITY", "RELATIONSHIPS", "CAREER", "HEALTH",
                "EMOTIONAL", "PURPOSE", "GROWTH", "FINANCES", "TIME", "TECHNOLOGY"
            ]

            coverage = {}
            counts = {r["domain"]: r["answer_count"] for r in domain_counts}

            for domain in all_domains:
                count = counts.get(domain, 0)
                coverage[domain] = min(1.0, count / 5.0)

            return coverage
```

### 4.2 –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –∞–≤—Ç–æ-—Ä–µ–∂–∏–º–∞
```sql
-- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤ –≤ –∞–≤—Ç–æ-—Ä–µ–∂–∏–º–µ
CREATE TABLE IF NOT EXISTS selfology.user_auto_progress (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL,
    block_id VARCHAR(150) NOT NULL,
    program_id VARCHAR(100) NOT NULL,
    completed_at TIMESTAMP DEFAULT NOW(),
    questions_answered INTEGER DEFAULT 0,

    UNIQUE(user_id, block_id)
);

CREATE INDEX idx_auto_progress_user ON selfology.user_auto_progress(user_id);
```

### 4.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Orchestrator
```python
async def start_auto_onboarding(self, user_id: int) -> Dict[str, Any]:
    """–ù–∞—á–∞—Ç—å –∞–≤—Ç–æ-–æ–Ω–±–æ—Ä–¥–∏–Ω–≥ ‚Äî AI –≤—ã–±–∏—Ä–∞–µ—Ç –±–ª–æ–∫"""

    # –í—ã–±–∏—Ä–∞–µ–º –±–ª–æ–∫
    selection = await self.auto_block_selector.select_next_block(user_id)

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —á—Ç–æ –≤—ã–±—Ä–∞–Ω–æ
    return {
        "mode": "auto",
        "block": selection,
        "message": f"–î–ª—è –≤–∞—Å –ø–æ–¥–æ–±—Ä–∞–Ω –±–ª–æ–∫: {selection['block_name']}\n"
                   f"–ò–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã: {selection['program_name']}\n"
                   f"–ü—Ä–∏—á–∏–Ω–∞: {selection['reason']}"
    }

async def get_next_auto_block(self, user_id: int) -> Dict[str, Any]:
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –±–ª–æ–∫ –≤ –∞–≤—Ç–æ-—Ä–µ–∂–∏–º–µ"""

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–∏–π –±–ª–æ–∫ –∫–∞–∫ –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–π
    await self._save_auto_progress(user_id, current_block_id)

    # –í—ã–±–∏—Ä–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π
    return await self.auto_block_selector.select_next_block(user_id)
```

### 4.4 –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ-—Ä–µ–∂–∏–º–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /onboarding ‚Üí –ê–≤—Ç–æ

AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å:
  - IDENTITY: 0.0 (–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö)
  - CAREER: 0.0 (–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö)
  - RELATIONSHIPS: 0.0 (–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö)

AI –≤—ã–±–∏—Ä–∞–µ—Ç: "–ó–¥–µ—Å—å –∏ —Å–µ–π—á–∞—Å" –∏–∑ "–ü–æ–¥—É–º–∞—Ç—å –æ –∂–∏–∑–Ω–∏"
–ü—Ä–∏—á–∏–Ω–∞: Foundation –±–ª–æ–∫ –¥–ª—è –Ω–∞—á–∞–ª–∞, –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç IDENTITY

‚Üí 4 –≤–æ–ø—Ä–æ—Å–∞ –±–ª–æ–∫–∞
‚Üí –ë–ª–æ–∫ –∑–∞–≤–µ—Ä—à—ë–Ω!

AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç:
  - IDENTITY: 0.6 (–µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ)
  - CAREER: 0.0 (–ø—Ä–æ–±–µ–ª!)
  - RELATIONSHIPS: 0.2

AI –≤—ã–±–∏—Ä–∞–µ—Ç: "–ì–¥–µ —è —Å–µ–π—á–∞—Å" –∏–∑ "–ü–æ–¥—É–º–∞—Ç—å –æ –∫–∞—Ä—å–µ—Ä–µ"
–ü—Ä–∏—á–∏–Ω–∞: –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–æ–±–µ–ª –≤ CAREER

‚Üí 5 –≤–æ–ø—Ä–æ—Å–æ–≤ –±–ª–æ–∫–∞
‚Üí ...
```

---

## –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|------|-----------|
| `selfology_controller.py` | –ù–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è FSM, –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã |
| `orchestrator.py` | –ú–µ—Ç–æ–¥—ã process_program_answer, update_program_progress |
| `program_router.py` | –£–∂–µ —Å–æ–∑–¥–∞–Ω ‚úÖ |
| `onboarding_dao.py` | –ú–µ—Ç–æ–¥—ã save_answer_with_program |
| `answer_analyzer.py` | –ü–µ—Ä–µ–¥–∞—á–∞ program_context |
| `embedding_creator.py` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ program_id –≤ payload |
| `services/chat_coach.py` | –£—á—ë—Ç block_type –≤ —Ä–æ—É—Ç–∏–Ω–≥–µ |

---

## –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| –≠—Ç–∞–ø | –ó–∞–¥–∞—á–∏ | –û—Ü–µ–Ω–∫–∞ |
|------|--------|--------|
| **MVP** | FSM + –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ + –±–∞–∑–æ–≤—ã–π flow | 2-3 —á–∞—Å–∞ |
| **–ê–Ω–∞–ª–∏–∑** | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ AnswerAnalyzer –∫ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º | 1-2 —á–∞—Å–∞ |
| **–ü—Ä–æ–≥—Ä–µ—Å—Å** | –£—á—ë—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞, –ø–µ—Ä–µ—Ö–æ–¥—ã –±–ª–æ–∫–æ–≤ | 1-2 —á–∞—Å–∞ |
| **–ê–≤—Ç–æ-–ø–æ–¥–±–æ—Ä** | AI –≤—ã–±–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã | 1 —á–∞—Å |
| **–¢–µ—Å—Ç—ã** | E2E —Ç–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ flow | 1 —á–∞—Å |
| **–ò—Ç–æ–≥–æ** | | **6-9 —á–∞—Å–æ–≤** |

---

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

| –†–∏—Å–∫ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-----------|
| –°—Ç–∞—Ä—ã–µ —Å–µ—Å—Å–∏–∏ –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã | –§–ª–∞–≥ `session_type: 'program' / 'classic'` |
| –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–µ | program_id –≤ –ë–î, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ user_program_progress |
| –î–æ–ª–≥–∏–π –∞–Ω–∞–ª–∏–∑ –±–ª–æ–∫–∏—Ä—É–µ—Ç UX | Background tasks –∫–∞–∫ —Å–µ–π—á–∞—Å |
